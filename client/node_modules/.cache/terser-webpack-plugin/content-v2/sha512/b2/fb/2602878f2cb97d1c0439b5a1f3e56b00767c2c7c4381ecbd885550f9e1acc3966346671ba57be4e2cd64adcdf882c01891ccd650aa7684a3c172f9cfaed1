{"code":"(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{62:function(e,t,n){},63:function(e,t,n){\"use strict\";n.r(t);var c,o=n(0),s=n.n(o),a=n(31),r=n.n(a),i=n(26),l=n(4),u=n(6),d=n(8),m=n(5),j=n(65),b=n(3),h=function(){var e=s.a.useState(\"\"),t=Object(m.a)(e,2),n=t[0],c=t[1],o=s.a.useState(\"\"),a=Object(m.a)(o,2),r=a[0],i=a[1],h=(Object(l.l)(),function(){var e=Object(d.a)(Object(u.a)().mark((function e(){var t;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=document.createElement(\"textarea\")).value=window.location.href+\"door_to_room/\"+n,document.body.appendChild(t),t.focus(),t.select(),document.execCommand(\"Copy\"),document.body.removeChild(t);case 7:case\"end\":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());return Object(b.jsxs)(\"div\",{className:\"home\",children:[Object(b.jsx)(\"button\",{onClick:function(){j.a.get(\"/create_room\").then((function(e){c(e.data)})).catch((function(e){alert(e.response.data.error)}))},children:\"Create room\"}),Object(b.jsxs)(\"div\",{style:{display:\"flex\"},children:[n.length>0&&Object(b.jsx)(\"button\",{className:\"copy button\",onClick:h,children:\"Copy room address\"}),Object(b.jsx)(\"textarea\",{style:{resize:\"none\"},disabled:!0,value:n})]}),Object(b.jsx)(\"input\",{onChange:function(e){return sessionStorage.setItem(\"name\",e.target.value)},className:\"name_box\",type:\"text\",placeholder:\"name\"}),Object(b.jsx)(\"input\",{onChange:function(e){return i(e.target.value)},className:\"roomID_box\",type:\"text\",placeholder:\"room ID\"}),Object(b.jsx)(\"button\",{onClick:function(){return window.location.href=\"/room/\".concat(r)},children:\"Join room\"})]})},g=n(11),p=function(){var e=new Date,t=e.getHours(),n=e.getMinutes();return\"\".concat(t,\":\").concat(n)},f=function(e){var t=e.messages;return Object(b.jsx)(b.Fragment,{children:t.map((function(e,t){return\"chat_msg\"===e.target?Object(b.jsxs)(\"div\",{className:\"msg\",children:[Object(b.jsxs)(\"div\",{style:{fontSize:\"20px\"},children:[e.name,\" \",\"(\".concat(p(),\")\")]}),e.msg]},t):\"participant\"===e.target?Object(b.jsx)(\"div\",{className:\"new_participant_msg\",children:\"\".concat(e.name,\" \").concat(e.msg)},t):{}}))})},O=s.a.memo(f),x=n(9),v=n(10),w=function(){function e(t){var n=this;Object(x.a)(this,e),this.targets=void 0,this.ws=void 0,this.is_open=void 0,this.ws=new WebSocket(t),this.targets=new Map,this.is_open=!1,this.ws.onopen=function(){n.is_open=!0},this.ws.onclose=function(e){console.log(e)},this.ws.onerror=function(e){console.log(e)},this.ws.onmessage=function(e){var t=JSON.parse(e.data);n.targets.get(t.target)(t)}}return Object(v.a)(e,[{key:\"on\",value:function(e,t){this.targets.set(e,t)}},{key:\"send\",value:function(e){this.ws.send(e)}}]),e}(),_=n(34),N=new Map,y=function(e){var t=e.ws,n=s.a.useRef(),o=s.a.useState(!1),a=Object(m.a)(o,2),r=a[0],i=a[1],l=s.a.useState(!1),u=Object(m.a)(l,2),d=u[0],j=u[1],h=function(){var e=c.getVideoTracks()[0].enabled;c.getVideoTracks()[0].enabled=!e,i(!r)},g=function(){var e=c.getAudioTracks()[0].enabled;c.getAudioTracks()[0].enabled=!e,j(!d)},p=function(e,t){e.srcObject=t,e.addEventListener(\"loadedmetadata\",(function(){e.play()})),n.current.append(e)};return s.a.useEffect((function(){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){c=e;var n,o=document.createElement(\"video\");o.muted=!0,p(o,e),t.on(\"uuid\",(function(c){(n=new _.a(c.uuid)).on(\"call\",(function(t){console.log(\"Call from a peer\"),t.answer(e);var n=document.createElement(\"video\");t.on(\"stream\",(function(e){p(n,e)}))})),n.on(\"open\",(function(e){console.log(\"You joined room as \"+e),t.send(JSON.stringify({target:\"new_peer\",peerID:e}))}))})),t.on(\"new_peer\",(function(t){console.log(\"you called a new peer\");var c=n.call(t.peerID,e),o=document.createElement(\"video\");c.on(\"stream\",(function(e){p(o,e)})),c.on(\"close\",(function(){o.remove()})),N.set(t.peerID,c)})),t.send(JSON.stringify({target:\"uuid\"}))})).catch((function(e){console.error(\"Failed to get local stream\",e)})),t.on(\"peer_disconnected\",(function(e){console.log(\"peer left\"),N.get(e.peerID).close(),N.delete(e.peerID)}))}),[t]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(\"div\",{className:\"video_grid\",ref:n}),Object(b.jsxs)(\"div\",{className:\"controller\",children:[Object(b.jsxs)(\"div\",{className:\"stream_control_block\",children:[r?Object(b.jsxs)(\"div\",{onClick:h,className:\"play stream_control_button\",children:[Object(b.jsx)(\"img\",{src:\"/icons/video.webp\",alt:\"\"}),Object(b.jsx)(\"span\",{children:\"Play Video\"})]}):Object(b.jsxs)(\"div\",{onClick:h,className:\"stream_control_button\",children:[Object(b.jsx)(\"img\",{src:\"/icons/video.webp\",alt:\"\"}),Object(b.jsx)(\"span\",{children:\"Stop Video\"})]}),d?Object(b.jsxs)(\"div\",{onClick:g,className:\"unmute stream_control_button\",children:[Object(b.jsx)(\"img\",{src:\"/icons/mic.webp\",alt:\"\"}),Object(b.jsx)(\"span\",{children:\"Unmute\"})]}):Object(b.jsxs)(\"div\",{onClick:g,className:\"stream_control_button\",children:[Object(b.jsx)(\"img\",{src:\"/icons/mic.webp\",alt:\"\"}),Object(b.jsx)(\"span\",{children:\"Mute\"})]})]}),Object(b.jsxs)(\"div\",{className:\"stream_control_block\",children:[Object(b.jsxs)(\"div\",{className:\"stream_control_button\",children:[Object(b.jsx)(\"img\",{src:\"/icons/participants.webp\",alt:\"\"}),Object(b.jsx)(\"span\",{children:\"Participants\"})]}),Object(b.jsxs)(\"div\",{className:\"stream_control_button\",children:[Object(b.jsx)(\"img\",{src:\"/icons/chat.webp\",alt:\"\"}),Object(b.jsx)(\"span\",{children:\"Chat\"})]})]}),Object(b.jsx)(\"div\",{onClick:function(){t.ws.close(),window.location.href=\"/\"},className:\"leave_meetig stream_control_button\",children:Object(b.jsx)(\"span\",{children:\"Leave Meeting\"})})]})]})},S=function(){var e=s.a.useState(\"\"),t=Object(m.a)(e,2),n=t[0],c=t[1],o=s.a.useState([]),a=Object(m.a)(o,2),r=a[0],i=a[1],l=s.a.useState([]),u=Object(m.a)(l,2),d=u[0],j=u[1],h=s.a.useRef([]),p=s.a.useRef(),f=s.a.useMemo((function(){return new w(\"wss://\".concat(window.location.hostname))}),[]);s.a.useEffect((function(){for(var e=window.location.href,t=e.length-1;\"/\"!==e[t];)t--;sessionStorage.setItem(\"roomID\",e.substring(t+1,e.length)),f.on(\"err\",(function(e){alert(\"Multiple connections not allowed!\"),console.log(e)})),f.on(\"participant\",(function(e){i(e.participants.split(\"/\")),e={target:e.target,name:e.name,msg:e.msg},h.current=[].concat(Object(g.a)(h.current),[e]),j(h.current)})),f.on(\"chat_msg\",(function(e){e={target:e.target,name:e.name,msg:e.msg},h.current=[].concat(Object(g.a)(h.current),[e]),j(h.current)}));var n=setInterval((function(){f.is_open&&(f.send(JSON.stringify({target:\"join_room\",name:sessionStorage.getItem(\"name\"),roomID:sessionStorage.getItem(\"roomID\")})),clearInterval(n))}),1)}),[]),s.a.useEffect((function(){p.current.scrollTop=p.current.scrollHeight}),[d]);return Object(b.jsxs)(\"div\",{className:\"room_frame\",children:[Object(b.jsx)(\"div\",{className:\"left_window\",style:{fontSize:\"50px\",textAlign:\"center\"},children:f.is_open?Object(b.jsx)(y,{ws:f}):Object(b.jsx)(b.Fragment,{})}),Object(b.jsxs)(\"div\",{className:\"chat_window\",children:[Object(b.jsxs)(\"div\",{className:\"chat_header\",children:[\"Chat\",Object(b.jsx)(\"br\",{}),Object(b.jsx)(\"div\",{className:\"participants\",children:r})]}),Object(b.jsx)(\"div\",{className:\"message_window\",ref:p,children:Object(b.jsx)(O,{messages:d})}),Object(b.jsx)(\"textarea\",{className:\"msg_input\",onChange:function(e){return c(e.target.value)},onKeyDown:function(e){\"Enter\"===e.key&&(e.preventDefault(),f.send(JSON.stringify({target:\"chat_msg\",msg:n})),c(\"\"))},placeholder:\"target message here\",value:n})]})]})},k=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(\"input\",{onChange:function(e){return sessionStorage.setItem(\"name\",e.target.value)},className:\"name_box\",type:\"text\",placeholder:\"name\",style:{fontSize:\"30px\"}}),Object(b.jsx)(\"button\",{className:\"join room button\",onClick:function(){return window.location.href=\"/room/\".concat(function(){for(var e=window.location.href,t=e.length-1;\"/\"!==e[t];)t--;return e.substring(t+1,e.length)}())},style:{fontSize:\"30px\"},children:\"Join room\"})]})};n(62);function C(){return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(i.a,{children:Object(b.jsxs)(l.c,{children:[Object(b.jsx)(l.a,{path:\"/\",element:Object(b.jsx)(h,{})}),Object(b.jsx)(l.a,{path:\"/door_to_room/*\",element:Object(b.jsx)(k,{})}),Object(b.jsx)(l.a,{path:\"/room/*\",element:Object(b.jsx)(S,{})})]})})})}r.a.createRoot(document.getElementById(\"root\")).render(Object(b.jsx)(C,{}))}},[[63,1,2]]]);","name":"static/js/main.92388bde.chunk.js","map":{"version":3,"names":["this","push","module","exports","__webpack_require__","__webpack_exports__","r","my_stream_","react","react_default","n","client","client_default","dist","react_router_dist","regeneratorRuntime","asyncToGenerator","slicedToArray","axios","jsx_runtime","pages_Home","_React$useState","a","useState","_React$useState2","Object","created_roomID","set_created_roomID","_React$useState3","_React$useState4","entered_roomID","set_entered_roomID","to_clip_board","_ref","mark","_callee","textArea","wrap","_context","prev","next","document","createElement","value","window","location","href","body","appendChild","focus","select","execCommand","removeChild","stop","apply","arguments","className","children","onClick","get","then","res","data","catch","error","alert","response","style","display","length","resize","disabled","onChange","e","sessionStorage","setItem","target","type","placeholder","concat","toConsumableArray","get_time","date","Date","hour","getHours","minute","getMinutes","Messages_Messages","messages","map","message","i","fontSize","name","msg","components_Messages","memo","classCallCheck","createClass","my_websocket","My_websocket","address","_this","targets","ws","is_open","WebSocket","Map","onopen","onclose","console","log","onerror","onmessage","json","JSON","parse","key","callback","set","send","bundler","peers","components_Streams","video_grid","useRef","play_toggled","set_play_toggled","mute_toggled","set_mute_toggled","toggle_play","enabled","getVideoTracks","toggle_mute","getAudioTracks","add_video_stream","video","stream","srcObject","addEventListener","play","current","append","useEffect","navigator","mediaDevices","getUserMedia","audio","my_stream","my_peer","my_video","muted","on","uuid","call","answer","remote_video","remoteStream","peerID","stringify","remove","err","close","delete","ref","src","alt","pages_Room","input_msg","set_input_msg","participants","set_participants","_React$useState5","_React$useState6","set_messages","messages_ref","message_window","useMemo","hostname","url","p","substring","split","interval","setInterval","getItem","roomID","clearInterval","scrollTop","scrollHeight","textAlign","onKeyDown","preventDefault","pages_DoorToRoom","find_roomID","App","path","element","createRoot","getElementById","render"],"sources":["static/js/main.92388bde.chunk.js"],"mappings":"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"},"input":"(this[\"webpackJsonpclient\"] = this[\"webpackJsonpclient\"] || []).push([[0],{\n\n/***/ 62:\n/***/ (function(module, exports, __webpack_require__) {\n\n// extracted by mini-css-extract-plugin\n\n/***/ }),\n\n/***/ 63:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(0);\nvar react_default = /*#__PURE__*/__webpack_require__.n(react);\n\n// EXTERNAL MODULE: ./node_modules/react-dom/client.js\nvar client = __webpack_require__(31);\nvar client_default = /*#__PURE__*/__webpack_require__.n(client);\n\n// EXTERNAL MODULE: ./node_modules/react-router-dom/dist/index.js\nvar dist = __webpack_require__(26);\n\n// EXTERNAL MODULE: ./node_modules/react-router/dist/index.js\nvar react_router_dist = __webpack_require__(4);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\nvar regeneratorRuntime = __webpack_require__(6);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\nvar asyncToGenerator = __webpack_require__(8);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 3 modules\nvar slicedToArray = __webpack_require__(5);\n\n// EXTERNAL MODULE: ./node_modules/axios/lib/axios.js + 34 modules\nvar axios = __webpack_require__(65);\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(3);\n\n// CONCATENATED MODULE: ./src/pages/Home.tsx\nvar Home_Home=function Home(){var _React$useState=react_default.a.useState(\"\"),_React$useState2=Object(slicedToArray[\"a\" /* default */])(_React$useState,2),created_roomID=_React$useState2[0],set_created_roomID=_React$useState2[1];var _React$useState3=react_default.a.useState(\"\"),_React$useState4=Object(slicedToArray[\"a\" /* default */])(_React$useState3,2),entered_roomID=_React$useState4[0],set_entered_roomID=_React$useState4[1];// const test=React.useRef(()=>{console.log('hi')})\nvar navigate=Object(react_router_dist[\"l\" /* useNavigate */])();// React.useEffect(()=>{\n// },[])\nvar create_room=function create_room(){axios[\"a\" /* default */].get('/create_room').then(function(res){// Go to login page if sign up is successful\nset_created_roomID(res.data);}).catch(function(error){alert(error.response.data.error);});};var to_clip_board=/*#__PURE__*/function(){var _ref=Object(asyncToGenerator[\"a\" /* default */])(/*#__PURE__*/Object(regeneratorRuntime[\"a\" /* default */])().mark(function _callee(){var textArea;return Object(regeneratorRuntime[\"a\" /* default */])().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:textArea=document.createElement(\"textarea\");textArea.value=window.location.href+'door_to_room/'+created_roomID;document.body.appendChild(textArea);textArea.focus();textArea.select();document.execCommand(\"Copy\");document.body.removeChild(textArea);//await navigator.clipboard.writeText(created_roomID);\ncase 7:case\"end\":return _context.stop();}}},_callee);}));return function to_clip_board(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"home\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{onClick:create_room,children:\"Create room\"}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{style:{display:\"flex\"},children:[created_roomID.length>0&&/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{className:\"copy button\",onClick:to_clip_board,children:\"Copy room address\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"textarea\",{style:{resize:'none'},disabled:true,value:created_roomID})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"input\",{onChange:function onChange(e){return sessionStorage.setItem('name',e.target.value);},className:\"name_box\",type:\"text\",placeholder:\"name\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"input\",{onChange:function onChange(e){return set_entered_roomID(e.target.value);},className:\"roomID_box\",type:\"text\",placeholder:\"room ID\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{onClick:function onClick(){return window.location.href=\"/room/\".concat(entered_roomID);},children:\"Join room\"})]});};/* harmony default export */ var pages_Home = (Home_Home);\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js + 3 modules\nvar toConsumableArray = __webpack_require__(11);\n\n// CONCATENATED MODULE: ./src/components/Messages.tsx\nvar get_time=function get_time(){var date=new Date();var hour=date.getHours();var minute=date.getMinutes();return\"\".concat(hour,\":\").concat(minute);};var Messages_Messages=function Messages(_ref){var messages=_ref.messages;return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(jsx_runtime[\"Fragment\"],{children:messages.map(function(message,i){return message.target==='chat_msg'?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"msg\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{style:{fontSize:'20px'},children:[message.name,\" \",\"(\".concat(get_time(),\")\")]}),message.msg]},i):message.target==='participant'?/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"new_participant_msg\",children:\"\".concat(message.name,\" \").concat(message.msg)},i):{};})});};// export default Messages\n/* harmony default export */ var components_Messages = (/*#__PURE__*/react_default.a.memo(Messages_Messages));\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/classCallCheck.js\nvar classCallCheck = __webpack_require__(9);\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/createClass.js\nvar createClass = __webpack_require__(10);\n\n// CONCATENATED MODULE: ./src/my_websocket.tsx\nvar my_websocket_My_websocket=/*#__PURE__*/function(){function My_websocket(address){var _this=this;Object(classCallCheck[\"a\" /* default */])(this,My_websocket);this.targets=void 0;this.ws=void 0;this.is_open=void 0;this.ws=new WebSocket(address);// console.log('my_websocket allocated')\nthis.targets=new Map();this.is_open=false;this.ws.onopen=function(){_this.is_open=true;};this.ws.onclose=function(msg){console.log(msg);};this.ws.onerror=function(error){console.log(error);};this.ws.onmessage=function(msg){// console.log(msg.data)\nvar json=JSON.parse(msg.data);_this.targets.get(json.target)(json);};}Object(createClass[\"a\" /* default */])(My_websocket,[{key:\"on\",value:function on(target,callback){this.targets.set(target,callback);}},{key:\"send\",value:function send(msg){this.ws.send(msg);}}]);return My_websocket;}();// console.log('my_websocket imported')\n/* harmony default export */ var my_websocket = (my_websocket_My_websocket);\n// EXTERNAL MODULE: ./node_modules/peerjs/dist/bundler.mjs\nvar bundler = __webpack_require__(34);\n\n// CONCATENATED MODULE: ./src/components/Streams.tsx\nvar peers=new Map();var my_stream_;var Streams_Streams=function Streams(_ref){var ws=_ref.ws;var video_grid=react_default.a.useRef();var _React$useState=react_default.a.useState(false),_React$useState2=Object(slicedToArray[\"a\" /* default */])(_React$useState,2),play_toggled=_React$useState2[0],set_play_toggled=_React$useState2[1];var _React$useState3=react_default.a.useState(false),_React$useState4=Object(slicedToArray[\"a\" /* default */])(_React$useState3,2),mute_toggled=_React$useState4[0],set_mute_toggled=_React$useState4[1];var toggle_play=function toggle_play(){var enabled=my_stream_.getVideoTracks()[0].enabled;if(enabled){my_stream_.getVideoTracks()[0].enabled=false;}else{my_stream_.getVideoTracks()[0].enabled=true;}set_play_toggled(!play_toggled);};var toggle_mute=function toggle_mute(){var enabled=my_stream_.getAudioTracks()[0].enabled;if(enabled){my_stream_.getAudioTracks()[0].enabled=false;}else{my_stream_.getAudioTracks()[0].enabled=true;}set_mute_toggled(!mute_toggled);};var add_video_stream=function add_video_stream(video,stream){video.srcObject=stream;video.addEventListener('loadedmetadata',function(){video.play();});video_grid.current.append(video);};var leave_meeting=function leave_meeting(){ws.ws.close();window.location.href='/';};react_default.a.useEffect(function(){navigator.mediaDevices.getUserMedia({video:true,audio:true}).then(function(my_stream){my_stream_=my_stream;var my_video=document.createElement('video');my_video.muted=true;add_video_stream(my_video,my_stream);var my_peer;ws.on('uuid',function(json){// received my uuid\nmy_peer=new bundler[\"a\" /* default */](json.uuid);my_peer.on('call',function(call){console.log('Call from a peer');call.answer(my_stream);var remote_video=document.createElement('video');call.on('stream',function(remoteStream){add_video_stream(remote_video,remoteStream);});});my_peer.on('open',function(peerID){console.log('You joined room as '+peerID);ws.send(JSON.stringify({target:\"new_peer\",peerID:peerID}));});});ws.on('new_peer',function(json){// New peer received\nconsole.log('you called a new peer');var call=my_peer.call(json.peerID,my_stream);var remote_video=document.createElement('video');call.on(\"stream\",function(remoteStream){// answer of the call\nadd_video_stream(remote_video,remoteStream);});call.on('close',function(){remote_video.remove();});peers.set(json.peerID,call);});ws.send(JSON.stringify({target:'uuid'}));}).catch(function(err){console.error(\"Failed to get local stream\",err);});ws.on('peer_disconnected',function(json){console.log('peer left');peers.get(json.peerID).close();peers.delete(json.peerID);});},[ws]);// React.useEffect(()=>{\n//     set_render(!render)\n// },[video_grid, render])\nreturn/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"video_grid\",ref:video_grid}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"controller\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"stream_control_block\",children:[play_toggled?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{onClick:toggle_play,className:\"play stream_control_button\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"img\",{src:\"/icons/video.webp\",alt:\"\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"span\",{children:\"Play Video\"})]}):/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{onClick:toggle_play,className:\"stream_control_button\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"img\",{src:\"/icons/video.webp\",alt:\"\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"span\",{children:\"Stop Video\"})]}),mute_toggled?/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{onClick:toggle_mute,className:\"unmute stream_control_button\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"img\",{src:\"/icons/mic.webp\",alt:\"\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"span\",{children:\"Unmute\"})]}):/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{onClick:toggle_mute,className:\"stream_control_button\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"img\",{src:\"/icons/mic.webp\",alt:\"\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"span\",{children:\"Mute\"})]})]}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"stream_control_block\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"stream_control_button\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"img\",{src:\"/icons/participants.webp\",alt:\"\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"span\",{children:\"Participants\"})]}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"stream_control_button\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"img\",{src:\"/icons/chat.webp\",alt:\"\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"span\",{children:\"Chat\"})]})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{onClick:leave_meeting,className:\"leave_meetig stream_control_button\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"span\",{children:\"Leave Meeting\"})})]})]});};/* harmony default export */ var components_Streams = (Streams_Streams);\n// CONCATENATED MODULE: ./src/pages/Room.tsx\nvar Room_Room=function Room(){var _React$useState=react_default.a.useState(\"\"),_React$useState2=Object(slicedToArray[\"a\" /* default */])(_React$useState,2),input_msg=_React$useState2[0],set_input_msg=_React$useState2[1];var _React$useState3=react_default.a.useState([]),_React$useState4=Object(slicedToArray[\"a\" /* default */])(_React$useState3,2),participants=_React$useState4[0],set_participants=_React$useState4[1];var _React$useState5=react_default.a.useState([]),_React$useState6=Object(slicedToArray[\"a\" /* default */])(_React$useState5,2),messages=_React$useState6[0],set_messages=_React$useState6[1];var messages_ref=react_default.a.useRef([]);var message_window=react_default.a.useRef();var ws=react_default.a.useMemo(function(){return new my_websocket(\"wss://\".concat(window.location.hostname));},[]);react_default.a.useEffect(function(){// Find roomID\nvar url=window.location.href;var p=url.length-1;while(url[p]!=='/'){p--;}sessionStorage.setItem('roomID',url.substring(p+1,url.length));ws.on('err',function(json){// window.location.reload()\nalert('Multiple connections not allowed!');console.log(json);});ws.on('participant',function(json){set_participants(json.participants.split('/'));json={target:json.target,name:json.name,msg:json.msg};messages_ref.current=[].concat(Object(toConsumableArray[\"a\" /* default */])(messages_ref.current),[json]);set_messages(messages_ref.current);});ws.on('chat_msg',function(json){json={target:json.target,name:json.name,msg:json.msg};messages_ref.current=[].concat(Object(toConsumableArray[\"a\" /* default */])(messages_ref.current),[json]);set_messages(messages_ref.current);});var interval=setInterval(function(){if(ws.is_open){ws.send(JSON.stringify({target:\"join_room\",name:sessionStorage.getItem('name'),roomID:sessionStorage.getItem('roomID')}));clearInterval(interval);}},1);},[]);react_default.a.useEffect(function(){message_window.current.scrollTop=message_window.current.scrollHeight;},[messages]);var send_msg=function send_msg(e){if(e.key!=='Enter')return;e.preventDefault();ws.send(JSON.stringify({target:'chat_msg',msg:input_msg}));set_input_msg('');};return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"room_frame\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"left_window\",style:{fontSize:'50px',textAlign:'center'},children:ws.is_open?/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(components_Streams,{ws:ws}):/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(jsx_runtime[\"Fragment\"],{})}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat_window\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"chat_header\",children:[\"Chat\",/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"br\",{}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"participants\",children:participants})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\",{className:\"message_window\",ref:message_window,children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(components_Messages,{messages:messages})}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"textarea\",{className:\"msg_input\",onChange:function onChange(e){return set_input_msg(e.target.value);},onKeyDown:send_msg,placeholder:\"target message here\",value:input_msg})]})]});};/* harmony default export */ var pages_Room = (Room_Room);\n// CONCATENATED MODULE: ./src/pages/DoorToRoom.tsx\nvar find_roomID=function find_roomID(){var url=window.location.href;var p=url.length-1;while(url[p]!=='/'){p--;}return url.substring(p+1,url.length);};var DoorToRoom_DoorToRoom=function DoorToRoom(){return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"input\",{onChange:function onChange(e){return sessionStorage.setItem('name',e.target.value);},className:\"name_box\",type:\"text\",placeholder:\"name\",style:{fontSize:'30px'}}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\",{className:\"join room button\",onClick:function onClick(){return window.location.href=\"/room/\".concat(find_roomID());},style:{fontSize:'30px'},children:\"Join room\"})]});};/* harmony default export */ var pages_DoorToRoom = (DoorToRoom_DoorToRoom);\n// EXTERNAL MODULE: ./src/style.css\nvar style = __webpack_require__(62);\n\n// CONCATENATED MODULE: ./src/App.tsx\nfunction App(){return/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(jsx_runtime[\"Fragment\"],{children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(dist[\"a\" /* BrowserRouter */],{children:/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(react_router_dist[\"c\" /* Routes */],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_router_dist[\"a\" /* Route */],{path:\"/\",element:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(pages_Home,{})}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_router_dist[\"a\" /* Route */],{path:\"/door_to_room/*\",element:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(pages_DoorToRoom,{})}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(react_router_dist[\"a\" /* Route */],{path:\"/room/*\",element:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(pages_Room,{})})]})})});}\n// CONCATENATED MODULE: ./src/index.tsx\nvar root=client_default.a.createRoot(document.getElementById(\"root\"));root.render(/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(App,{}));// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n//reportWebVitals();\n\n/***/ })\n\n},[[63,1,2]]]);","inputSourceMap":{"version":3,"sources":["G:\\Software\\github\\video-conference\\client\\node_modules\\mini-css-extract-plugin\\dist\\loader.js??ref--5-oneOf-4-0!G:\\Software\\github\\video-conference\\client\\node_modules\\css-loader\\dist\\cjs.js??ref--5-oneOf-4-1!G:\\Software\\github\\video-conference\\client\\node_modules\\postcss-loader\\src\\index.js??postcss!G:\\Software\\github\\video-conference\\client\\src\\style.css","G:/Software/github/video-conference/client/src/pages/Home.tsx","G:/Software/github/video-conference/client/src/components/Messages.tsx","G:/Software/github/video-conference/client/src/my_websocket.tsx","G:/Software/github/video-conference/client/src/components/Streams.tsx","G:/Software/github/video-conference/client/src/pages/Room.tsx","G:/Software/github/video-conference/client/src/pages/DoorToRoom.tsx","G:/Software/github/video-conference/client/src/App.tsx","G:/Software/github/video-conference/client/src/index.tsx"],"names":["Home","React","useState","created_roomID","set_created_roomID","entered_roomID","set_entered_roomID","navigate","useNavigate","create_room","axios","get","then","res","data","catch","error","alert","response","to_clip_board","textArea","document","createElement","value","window","location","href","body","appendChild","focus","select","execCommand","removeChild","display","length","resize","e","sessionStorage","setItem","target","get_time","date","Date","hour","getHours","minute","getMinutes","Messages","messages","map","message","i","fontSize","name","msg","memo","My_websocket","address","targets","ws","is_open","WebSocket","Map","onopen","onclose","console","log","onerror","onmessage","json","JSON","parse","callback","set","send","peers","my_stream_","Streams","video_grid","useRef","play_toggled","set_play_toggled","mute_toggled","set_mute_toggled","toggle_play","enabled","getVideoTracks","toggle_mute","getAudioTracks","add_video_stream","video","stream","srcObject","addEventListener","play","current","append","leave_meeting","close","useEffect","navigator","mediaDevices","getUserMedia","audio","my_stream","my_video","muted","my_peer","on","Peer","uuid","call","answer","remote_video","remoteStream","peerID","stringify","remove","err","delete","Room","input_msg","set_input_msg","participants","set_participants","set_messages","messages_ref","message_window","useMemo","hostname","url","p","substring","split","interval","setInterval","getItem","roomID","clearInterval","scrollTop","scrollHeight","send_msg","key","preventDefault","textAlign","find_roomID","DoorToRoom","App","root","ReactDOM","createRoot","getElementById","render"],"mappings":"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","file":"x","sourcesContent":["// extracted by mini-css-extract-plugin","import React from \"react\";\r\nimport axios from 'axios'\r\nimport {useNavigate} from \"react-router-dom\";\r\n\r\nconst Home = () => {\r\n  const [created_roomID, set_created_roomID] = React.useState(\"\");\r\n  const [entered_roomID, set_entered_roomID] = React.useState(\"\");\r\n  // const test=React.useRef(()=>{console.log('hi')})\r\n  const navigate = useNavigate();\r\n  // React.useEffect(()=>{\r\n  // },[])\r\n\r\n  const create_room=()=>{\r\n    axios.get('/create_room', )\r\n    .then(res => { // Go to login page if sign up is successful\r\n      set_created_roomID(res.data)\r\n    })\r\n    .catch(error=>{\r\n      alert(error.response.data.error)\r\n    }) \r\n  }\r\n\r\n  const to_clip_board=async()=>{\r\n    const textArea = document.createElement(\"textarea\");\r\n    textArea.value = window.location.href+'door_to_room/'+created_roomID;\r\n    document.body.appendChild(textArea);\r\n    textArea.focus();\r\n    textArea.select();\r\n    document.execCommand(\"Copy\");\r\n    document.body.removeChild(textArea);\r\n    //await navigator.clipboard.writeText(created_roomID);\r\n  }\r\n\r\n  return(\r\n    <div className=\"home\">\r\n      <button onClick={create_room}>Create room</button>\r\n      <div style={{display:\"flex\"}}>\r\n        {created_roomID.length>0 && <button className={`copy button`} onClick={to_clip_board}>Copy room address</button>}\r\n        <textarea style={{resize: 'none'}} disabled={true} value={created_roomID}></textarea>\r\n      </div>\r\n      <input onChange={(e) => sessionStorage.setItem('name', e.target.value)} className=\"name_box\" type=\"text\" placeholder=\"name\" />\r\n      <input onChange={(e) => set_entered_roomID(e.target.value)} className=\"roomID_box\" type=\"text\" placeholder=\"room ID\" />\r\n      <button onClick={()=>(window.location.href=`/room/${entered_roomID}`)}>Join room</button>\r\n    </div>\r\n  )\r\n}\r\nexport default Home","import React from 'react'\r\n\r\nexport interface Msg{\r\n    target: string;\r\n    name: string\r\n    msg: string;\r\n}\r\n\r\ninterface Msgs{\r\n    messages: Msg[]\r\n}\r\n\r\nconst get_time=()=>{\r\n    const date=new Date()\r\n    const hour=date.getHours()\r\n    const minute=date.getMinutes()\r\n    return `${hour}:${minute}`\r\n}\r\n\r\nconst Messages=({messages}: Msgs)=>{\r\n    return(\r\n    <>\r\n    {messages.map((message, i)=>(\r\n        message.target==='chat_msg'?\r\n        <div className='msg' key={i}>\r\n            <div style={{fontSize: '20px'}}>{message.name} {`(${get_time()})`}</div>\r\n            {message.msg}\r\n        </div>\r\n        : message.target==='participant'?\r\n        <div className='new_participant_msg' key={i}>\r\n            {`${message.name} ${message.msg}`}\r\n        </div>\r\n        :{}\r\n    ))}\r\n    </>)\r\n}\r\n// export default Messages\r\nexport default React.memo(Messages);"," class My_websocket{\r\n    targets: Map<string, any>;\r\n    ws: any\r\n    is_open: boolean\r\n    constructor(address: string) {\r\n        this.ws=new WebSocket(address)\r\n        // console.log('my_websocket allocated')\r\n        this.targets=new Map()\r\n        this.is_open=false\r\n        this.ws.onopen = () => {\r\n            this.is_open=true\r\n        }\r\n        this.ws.onclose = (msg: any) => {\r\n            console.log(msg)\r\n        };\r\n        this.ws.onerror = (error: any) => {\r\n            console.log(error)\r\n        };\r\n        this.ws.onmessage=(msg: any)=>{\r\n            // console.log(msg.data)\r\n            let json: any=JSON.parse(msg.data)\r\n            this.targets.get(json.target)(json)\r\n        }\r\n    }\r\n    on(target: string, callback: (json: any)=>void){\r\n        this.targets.set(target, callback)\r\n    }\r\n    send(msg: string){\r\n        this.ws.send(msg)\r\n    }\r\n}\r\n// console.log('my_websocket imported')\r\nexport default My_websocket","import React from \"react\";\r\nimport My_websocket from '../my_websocket'\r\nimport Peer from 'peerjs'\r\n\r\nlet peers=new Map()\r\nlet my_stream_: MediaStream\r\ninterface ws_{\r\n    ws: My_websocket\r\n  }\r\nconst Streams=({ws}: ws_)=>{\r\n    const video_grid=React.useRef<any>()\r\n    const [play_toggled, set_play_toggled]=React.useState(false)\r\n    const [mute_toggled, set_mute_toggled]=React.useState(false)\r\n\r\n    const toggle_play = () => {\r\n        let enabled = my_stream_.getVideoTracks()[0].enabled;\r\n        if (enabled) {\r\n            my_stream_.getVideoTracks()[0].enabled = false;\r\n        } else {\r\n          my_stream_.getVideoTracks()[0].enabled = true;\r\n        }\r\n        set_play_toggled(!play_toggled)\r\n      }\r\n\r\n    const toggle_mute = () => {\r\n        const enabled = my_stream_.getAudioTracks()[0].enabled;\r\n        if (enabled) {\r\n            my_stream_.getAudioTracks()[0].enabled = false;\r\n        } else {\r\n          my_stream_.getAudioTracks()[0].enabled = true;\r\n        }\r\n        set_mute_toggled(!mute_toggled)\r\n      }\r\n\r\n      const add_video_stream=(video: HTMLVideoElement, stream: MediaStream)=>{\r\n        video.srcObject = stream\r\n        video.addEventListener('loadedmetadata', () => {\r\n            video.play()\r\n        })\r\n        video_grid.current.append(video)\r\n    }\r\n\r\n    const leave_meeting=()=>{\r\n        ws.ws.close()\r\n        window.location.href='/'\r\n    }\r\n\r\n    React.useEffect(()=>{\r\n        navigator.mediaDevices.getUserMedia({ video: true, audio: true })\r\n        .then(my_stream => {\r\n            my_stream_=my_stream\r\n            const my_video = document.createElement('video')\r\n            my_video.muted=true\r\n            add_video_stream(my_video, my_stream)\r\n\r\n            let my_peer: Peer\r\n            ws.on('uuid', (json: any)=>{ // received my uuid\r\n                my_peer=new Peer(json.uuid)\r\n                my_peer.on('call', (call: any) => {\r\n                    console.log('Call from a peer')\r\n                    call.answer(my_stream)\r\n                    const remote_video = document.createElement('video')\r\n                    call.on('stream', (remoteStream: MediaStream) => {\r\n                        add_video_stream(remote_video, remoteStream)\r\n                    })\r\n                })\r\n                my_peer.on('open', peerID => {\r\n                    console.log('You joined room as '+peerID)\r\n                    ws.send(JSON.stringify({target: \"new_peer\", peerID: peerID}))\r\n                })\r\n            })\r\n            ws.on('new_peer', (json: any)=>{ // New peer received\r\n                console.log('you called a new peer')\r\n                const call = my_peer.call(json.peerID, my_stream);\r\n                const remote_video = document.createElement('video')\r\n                call.on(\"stream\", (remoteStream) => { // answer of the call\r\n                    add_video_stream(remote_video, remoteStream)\r\n                });\r\n                call.on('close', () => {\r\n                    remote_video.remove()\r\n                })\r\n                peers.set(json.peerID, call)\r\n            })\r\n            ws.send(JSON.stringify({target: 'uuid'}))\r\n        })\r\n        .catch(err => {\r\n            console.error(\"Failed to get local stream\", err);\r\n        })\r\n        \r\n        ws.on('peer_disconnected', (json: any)=>{\r\n            console.log('peer left')\r\n            peers.get(json.peerID).close()\r\n            peers.delete(json.peerID)\r\n        })\r\n    },[ws])\r\n\r\n    // React.useEffect(()=>{\r\n    //     set_render(!render)\r\n    // },[video_grid, render])\r\n\r\n    return(\r\n        <>\r\n        <div className=\"video_grid\" ref={video_grid}></div>\r\n        <div className=\"controller\">\r\n            <div className=\"stream_control_block\">\r\n                {play_toggled?\r\n                <div onClick={toggle_play} className=\"play stream_control_button\" >\r\n                    <img src='/icons/video.webp' alt=\"\"/>\r\n                    <span>Play Video</span>\r\n                </div>\r\n                :\r\n                <div onClick={toggle_play} className=\"stream_control_button\" >\r\n                    <img src='/icons/video.webp' alt=\"\"/>\r\n                    <span>Stop Video</span>\r\n                </div>}\r\n                {mute_toggled?\r\n                <div onClick={toggle_mute} className=\"unmute stream_control_button\" >\r\n                    <img src='/icons/mic.webp' alt=\"\"/>\r\n                    <span>Unmute</span>\r\n                </div>\r\n                :\r\n                <div onClick={toggle_mute} className=\"stream_control_button\" >\r\n                    <img src='/icons/mic.webp' alt=\"\"/>\r\n                    <span>Mute</span>\r\n                </div>}\r\n            </div>\r\n            <div className=\"stream_control_block\">\r\n                <div className=\"stream_control_button\">\r\n                    <img src='/icons/participants.webp' alt=\"\"/>\r\n                    <span>Participants</span>\r\n                </div>\r\n                <div className=\"stream_control_button\">\r\n                    <img src='/icons/chat.webp' alt=\"\"/>\r\n                    <span>Chat</span>\r\n                </div>\r\n            </div>\r\n            <div onClick={leave_meeting} className=\"leave_meetig stream_control_button\">\r\n                <span>Leave Meeting</span>\r\n            </div>\r\n        </div>\r\n        </>\r\n    )\r\n}\r\nexport default Streams","import React from \"react\";\r\nimport Messages from '../components/Messages'\r\nimport {Msg} from '../components/Messages'\r\nimport My_websocket from '../my_websocket'\r\nimport Streams from '../components/Streams'\r\n\r\nconst Room = () => {\r\n  const [input_msg, set_input_msg] = React.useState(\"\");\r\n  const [participants, set_participants] = React.useState<string[]>([])\r\n  const [messages, set_messages]=React.useState<Msg[]>([])\r\n  const messages_ref=React.useRef<Msg[]>([])\r\n  const message_window=React.useRef<any>()\r\n  const ws=React.useMemo(()=>new My_websocket(`wss://${window.location.hostname}`),[])\r\n\r\n  React.useEffect(()=>{\r\n    // Find roomID\r\n    let url=window.location.href\r\n    let p=url.length-1\r\n    while(url[p]!=='/') p--\r\n    sessionStorage.setItem('roomID', url.substring(p+1, url.length))\r\n\r\n    ws.on('err', (json: any)=>{\r\n      // window.location.reload()\r\n      alert('Multiple connections not allowed!')\r\n      console.log(json)\r\n    })\r\n    ws.on('participant', (json: any)=>{\r\n      set_participants(json.participants.split('/'))\r\n      json={target: json.target, name: json.name, msg: json.msg}\r\n      messages_ref.current=[...messages_ref.current, json]\r\n      set_messages(messages_ref.current)\r\n    })\r\n    ws.on('chat_msg', (json: any)=>{\r\n      json={target: json.target, name: json.name, msg: json.msg}\r\n      messages_ref.current=[...messages_ref.current, json]\r\n      set_messages(messages_ref.current)\r\n    })\r\n    const interval=setInterval(()=>{\r\n      if(ws.is_open){\r\n        ws.send(JSON.stringify({target: \"join_room\", name: sessionStorage.getItem('name'), roomID: sessionStorage.getItem('roomID')}))\r\n        clearInterval(interval)\r\n      }\r\n    }, 1)\r\n  },[])\r\n\r\n  React.useEffect(()=>{\r\n    message_window.current.scrollTop = message_window.current.scrollHeight\r\n  },[messages])\r\n\r\n  const send_msg=(e: any)=>{\r\n    if(e.key!=='Enter')\r\n      return\r\n    e.preventDefault()\r\n    ws.send(JSON.stringify({target: 'chat_msg', msg: input_msg}))\r\n    set_input_msg('')\r\n  }\r\n\r\n  return(\r\n    <div className=\"room_frame\">\r\n      <div className=\"left_window\" style={{fontSize: '50px', textAlign: 'center'}}>\r\n        {ws.is_open? <Streams ws={ws}/>: <></>}\r\n      </div>\r\n      <div className=\"chat_window\">\r\n        <div className=\"chat_header\">\r\n          Chat<br/>\r\n          <div className='participants'>{participants}</div>\r\n        </div>\r\n        <div className=\"message_window\" ref={message_window}>\r\n          <Messages messages={messages}/>\r\n        </div>\r\n        <textarea className=\"msg_input\" onChange={\r\n          (e) => set_input_msg(e.target.value)} onKeyDown={send_msg} placeholder='target message here' value={input_msg} />\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\nexport default Room;","import React from 'react'\r\n\r\nconst find_roomID=()=>{\r\n    let url=window.location.href\r\n    let p=url.length-1\r\n    while(url[p]!=='/') p--\r\n    return url.substring(p+1, url.length)\r\n}\r\n\r\nconst DoorToRoom=()=>{\r\n    return(\r\n        <>\r\n        <input onChange={(e) => sessionStorage.setItem('name', e.target.value)} className=\"name_box\" type=\"text\" placeholder=\"name\"\r\n        style={{fontSize: '30px'}}/>\r\n        <button className={`join room button`} onClick={()=>((window.location.href=`/room/${find_roomID()}`))}style={{fontSize: '30px'}}>Join room</button>\r\n        </>\r\n    )\r\n}\r\nexport default DoorToRoom","import React from \"react\";\r\nimport { BrowserRouter, Routes, Route } from \"react-router-dom\";\r\nimport Home from './pages/Home';\r\nimport Room from './pages/Room';\r\nimport DoorToRoom from './pages/DoorToRoom';\r\nimport \"./style.css\";\r\nimport My_websocket from './my_websocket'\r\n\r\nexport default function App() {\r\n  return (\r\n    <>\r\n      <BrowserRouter>\r\n        <Routes>\r\n          <Route path=\"/\" element={<Home/>}/>\r\n          <Route path=\"/door_to_room/*\" element={<DoorToRoom/>}/>\r\n          <Route path=\"/room/*\" element={<Room/>}/>\r\n        </Routes>\r\n      </BrowserRouter>\r\n    </>\r\n  )\r\n}","import React from 'react';\r\nimport ReactDOM from 'react-dom/client';\r\nimport App from './App'\r\n\r\nconst root = ReactDOM.createRoot(document.getElementById(\"root\") as HTMLElement);\r\nroot.render(\r\n  <App/>\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\n//reportWebVitals();\r\n"]}}